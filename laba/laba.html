<!DOCTYPE html>
<html>
<head>

<meta charset="utf-8" />
<title>Ура, методы!</title>

<style type="text/css">
    header, div { display:block;
    text-align:center; }
</style>

</head>
<body>
    <div id="wrapper">
        <header>
            А вот и методы на десяточку...
        </header>
        <div>
            <a href="m/plot_Left_r.m">Левые</a>
            <a href="m/plot_Right_r.m">Правые</a>
            <a href="m/plot_Centr_r.m">Центральные</a>
            <a href="m/plot_trap_m.m">трапы</a>
            <a href="m/plot_method_Sympson.m">Симпсон aka параболы</a>


        </div>



        <div>

          function [] = Monte_Karlo (a,b,n)
          test_x=a:1/1000:b;
          test_y=f(test_x);

          x=a+(b-a).*rand(n,1);

          min_v=min(f(a:1/n:b));
          max_v=max(f(a:1/n:b));

          y=min_v+(max_v-min_v).*rand(n,1);

          S=(b-a)/n;
          counter=0;

          hold on;
          grid on;
          plot (test_x, test_y,'k');

          for i=1:1:n
            if (y(i)<f(x(i)))
              if (f(x(i))>0)
                if (y(i)>0)
                plot (x(i),y(i),'*g');
                else
                plot (x(i),y(i),'*r');
                end
                else plot (x(i),y(i),'*r');
              end
                counter=counter+1;

                else
                if f(x(i)<0)
                  if (y(i)<0)
                   plot (x(i),y(i),'*g');
                  else
                   plot (x(i),y(i),'*r');
                  end
                else
                 plot (x(i),y(i),'*r');
                end
            end
          end
          Fn=S*counter/n;
          sum=0;
          for i=1:1:n
          sum=sum+f(x(i));
          end

            Fn2=sum*(b-a)*n;
            % final out
            fprintf("\n Final Integral: %d\n",Fn2*10.^(-6));
            fprintf(" point amount: %d \n", n);
            legend('f(x)=1./(3+cos(x))')

            xlabel('X axis')
            ylabel('Y axis')
          endfunction
</div>
<div>
          function [] = plot_Centr_r(x_low, x_high, Tolerance)

          n = 2;
          h = (x_high - x_low)/n;

          Iteration_stop_flag = false;
          Integral_previous = 0;

          Vector_x = [];
          Vector_y = [];

          while (Iteration_stop_flag != true)
            S = 0;
            for k=1:1:n
              x = x_low + k*h - h/2;
              S = S + f(x);
              Vector_x = [Vector_x, x];
              Vector_y = [Vector_y, f(x)];
            end
            Integral = S*h;
            if (abs(Integral-Integral_previous) < Tolerance)
              Iteration_stop_flag = true;
            else
              n = n*2;
              h = h/2;
              Integral_previous = Integral;
              Vector_x = [];
              Vector_y = [];
            end
          end
           % out:
            fprintf("\n Final integral: %d \n", Integral);
            fprintf(" value of n: %d \n", n);
            fprintf(" Step amount: %d \n", h);
             % graph:
            a = [pi/3:0.05:pi/2];
            plot(a, f(a), 'r')
            legend('f(x)=1./(3+cos(x))')
            xlabel('X axis')
            ylabel('Y axis')
            hold on
            bar(Vector_x, Vector_y, 'y')
          endfunction
</div>
<div>
          function [] = plot_Left_r(x_low, x_high, Tolerance)
          n = 2;
          h = (x_high - x_low )/n;
          Iteration_stop_flag = false;
          Integral_previous = 0;
          Vector_x = [];
          Vector_y = [];
          while (Iteration_stop_flag != true)
            S=0;
            for k=1:1:n
              x = x_low + (k-1)*h;
              S = S + f(x);
              Vector_x = [Vector_x, x];
              Vector_y = [Vector_y, f(x)];
            end
            Integral = S*h;
            if (abs(Integral - Integral_previous) < Tolerance)
              Iteration_stop_flag = true;
            else
              n = n *2;
              h = h/2;
              Integral_previous = Integral;
              Vector_x = [];
              Vector_y = [];
            end
          end
           % out:
            fprintf("\n Final integral: %d \n", Integral);
            fprintf(" value of n: %d \n", n);
            fprintf(" Step amount: %d \n", h);
             % graph:
            a = [pi/3:0.05:pi/2];
            plot(a, f(a), 'r')
            legend('f(x)=1./(3+cos(x))')
            xlabel('X axis')
            ylabel('Y axis')
            hold on
            bar(Vector_x, Vector_y, 'y')
          endfunction
</div>
<div>
          function [] = plot_Method_3_8(x_low, x_high, Tolerance)

          n = 2;
          m = 1;

          h = (x_high - x_low)/n;
          Integral_previous = 0;

          Vector_x = [];
          Vector_y = [];

          while (1)
            S = 0;
            for k = 1:1:m
              x = x_low + 2*(k - 1)*h;
              S = S + f(x) + 4*f(x + h) + f(x + 2*h);
              Vector_x = [Vector_x, x];
              Vector_y = [Vector_y, f(x)];
            end
          Integral = S*h/3;
            if (abs(Integral - Integral_previous) < Tolerance)
              break;
            else
            m = n;
            n = n*2;
            h = h/2;
          Integral_previous = Integral;
          Vector_x = [];
              Vector_y = [];
          end
          end

           % out:
            fprintf("\n Final integral: %d \n", Integral);
            fprintf(" value of n: %d \n", n);
            fprintf(" Step amount: %d \n", h);
             % graph:
            a = [pi/3:0.05:pi/2];
            plot(a, f(a), 'r')
            legend('f(x)=1./(3+cos(x))')
            xlabel('X axis')
            ylabel('Y axis')
            hold on
            bar(Vector_x, Vector_y, 'y')
          end
</div>

<div>
          function [] = plot_Right_r(x_low, x_high, Tolerance)
          n = 2;
          h = (x_high - x_low)/n;
          Iteration_stop_flag = false;
          Integral_previous = 0;
          Vector_x = [];
          Vector_y = [];
          while (Iteration_stop_flag != true)
            S = 0;
            for k=1:1:n
              x = x_low + k*h;
              S = S + f(x);
              Vector_x = [Vector_x, x];
              Vector_y = [Vector_y, f(x)];
            end
            Integral = S*h;
            if (abs(Integral-Integral_previous) < Tolerance)
              Iteration_stop_flag = true;
            else
              n = n*2;
              h = h/2;
              Integral_previous = Integral;
              Vector_x = [];
              Vector_y = [];
            end
          end
           % out:
            fprintf("\n Final integral: %d \n", Integral);
            fprintf(" value of n: %d \n", n);
            fprintf(" Step amount: %d \n", h);
            % graph:
            a = [pi/3:0.05:pi/2];
            plot(a, f(a), 'r')
            legend('f(x)=1./(3+cos(x))')
            xlabel('X axis')
            ylabel('Y axis')
            hold on
            bar(Vector_x, Vector_y, 'y')
          endfunction
</div>
<div>
          function [] = plot_trap_m (x_low, x_high, Tolerance)

          n = 2;
          h = (x_high - x_low)/n;

          Iteration_stop_flag = false;
          Integral_previous = 0;

          Vx=[];
          Vy=[];

          while (Iteration_stop_flag != true)
            S = (f(x_low) + f(x_high))/2;
            for k=1:1:n-1
              x = x_low + k*h;
              S = S + f(x);
              Vx=[Vx,x];
                   Vy=[Vy,f(x)];
                   hold on;
            end
            Integral = S*h;
            if (abs(Integral-Integral_previous) < Tolerance)
            else
              n = n*2;
              h = h/2;
              Integral_previous = Integral;
              Iteration_stop_flag = true;
              Vx=[];
              Vy=[];
            end
          end

           % out:
            fprintf("\n Final integral: %d \n", Integral);
            fprintf(" value of n: %d \n", n);
            fprintf(" Step amount: %d \n", h);

                % graph:
            a = [pi/3:0.05:pi/2];
            plot(a, f(a), 'r')
            legend('f(x)=1./(3+cos(x))')

              picture(x_low,x_high,10);
              xlabel('X axis')
              ylabel('Y axis')
              hold on
          endfunction
</div>
<div>
          % draw
            function [] = picture(x_low,x_high,n)
                h = (x_high - x_low)./n;
                x = x_low;
                Px=[];
                Py=[];
                Vx=[];
                Vy=[];
                Vx=[Vx,x];
                Vy=[Vy,f(x)];
                for i=1:n
                    i=i+1;
                    Px=[x x];
                    Py=[0 f(x)];
                    x = x+h;
                    Vx=[Vx,x];
                    Vy=[Vy,f(x)];
                    plot(Px,Py,'r',Vx,Vy,'r');
                end
             end

</div>
<div>

++extramethod:

function [] = plot_Method_Sympson (a, b, m)
n=2*m;
h=(b-a)/n;
s=0;
for k=1:1:m
x1=a+2*h*(k-1);
x2=x1+h;
x3=a+2*h*k;
f_x1=f(x1);
f_x2=f(x2);
f_x3=f(x3);
p=polyfit([x1 x2 x3], [f_x1 f_x2 f_x3],2);
t=polyval (p,x1:abs(x3-x1)/40:x3);
hold on;
plot (x1:abs(x3-x1)/40:x3,t,'r');
plot([x1 x1], [0 f_x1], 'b');
plot([x3 x3], [0 f_x3], 'b');
legend('f(x)=2sin(2x)')
title("Sympsons' Method")
xlabel('X axis')
ylabel('Y axis')
s=s+h/3*(f_x1+4*f_x2+f_x3);
end

endfunction
</div>
        </div>
    </div>
</body>
</html>
